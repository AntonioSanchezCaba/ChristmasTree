<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üíß Water Tank System</title>
    <link href="https://fonts.googleapis.com/css2?family=DM+Sans:ital,opsz,wght@0,9..40,300;0,9..40,400;0,9..40,500;0,9..40,600;0,9..40,700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/water.css">
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
</head>
<body>
    <nav class="top-nav">
        <div class="nav-links">
            <a href="index.html">üéÑ Christmas Tree</a>
            <span class="separator">|</span>
            <a href="water.html" class="active">üíß Water Tank System</a>
        </div>
        <div class="nav-auth">
            <div class="nav-auth-buttons" id="navAuthButtons" style="display: none;">
                <a href="index.html" class="login-btn">üîê Login</a>
            </div>
            <div class="nav-dropdown" id="navUserDropdown" style="display: none;">
                <div class="nav-user" onclick="toggleUserDropdown()">
                    <div class="nav-user-avatar">üë§</div>
                    <div class="nav-user-info"><span class="nav-user-name" id="navUserName">User</span></div>
                    <span class="nav-user-dropdown-arrow">‚ñº</span>
                </div>
                <div class="nav-dropdown-menu" id="navDropdownMenu">
                    <a href="index.html">üéÑ Go to Tree Controls</a>
                    <button class="logout-btn" onclick="handleLogout()">üö™ Cerrar Sesi√≥n</button>
                </div>
            </div>
        </div>
    </nav>

    <div class="dashboard">
        <div class="dash-header">
            <div class="dash-header-row">
                <div><h1>üíß Water Tank System</h1><p>Dual Tinaco Monitoring ‚Äî Supply &amp; Consumption</p></div>
                <div class="live-badge"><span class="dot"></span><span id="clock">--</span></div>
            </div>
        </div>

        <div class="overview-row">
            <div class="o-card t1"><div class="o-label">Tinaco 1 Level</div><div class="o-val" id="ov-t1">78<span>%</span></div><div class="o-tag up">‚ñ≤ 3% /hr</div></div>
            <div class="o-card t2"><div class="o-label">Tinaco 2 Level</div><div class="o-val" id="ov-t2">62<span>%</span></div><div class="o-tag down">‚ñº 5% /hr</div></div>
            <div class="o-card ok"><div class="o-label">Total Supply Today</div><div class="o-val" id="ov-sup">584<span> L</span></div><div class="o-tag up">‚ñ≤ 8% vs avg</div></div>
            <div class="o-card warn"><div class="o-label">Total Consumed Today</div><div class="o-val" id="ov-con">421<span> L</span></div><div class="o-tag flat">‚óè Normal</div></div>
        </div>

        <div class="tanks-row">
            <!-- TINACO 1 -->
            <div class="tank-card t1">
                <div class="tc-header"><div class="tc-title">üíß Tinaco 1</div><div class="tc-badge">ROOF ‚Äî FRONT</div></div>
                <div class="tc-body">
                    <div class="tank-vis">
                        <div class="tank-wrap">
                            <div class="tank-top"><div class="tank-pipe"></div></div>
                            <div class="tank-shell">
                                <div class="tank-fill" id="t1-fill" style="height:78%;">
                                    <div class="bbl" style="width:5px;height:5px;left:22%;bottom:8%;animation-delay:0s;"></div>
                                    <div class="bbl" style="width:4px;height:4px;left:58%;bottom:4%;animation-delay:1.3s;"></div>
                                    <div class="bbl" style="width:6px;height:6px;left:72%;bottom:14%;animation-delay:2.6s;"></div>
                                </div>
                            </div>
                            <div class="tank-scale"><span class="s-mk">100</span><span class="s-mk">75</span><span class="s-mk">50</span><span class="s-mk">25</span><span class="s-mk">0</span></div>
                        </div>
                        <div class="tank-pct" id="t1-pct">78<span>%</span></div>
                    </div>
                    <div class="tc-info">
                        <div class="tc-info-grid">
                            <div class="tc-metric supply-in">
                                <div class="tc-metric-label"><span class="ind supply"></span> Supply In</div>
                                <div class="tc-metric-val" id="t1-sup-val">2.4<span> L/min</span></div>
                                <div class="tc-metric-sub" id="t1-sup-total">312 L today</div>
                                <div class="mini-bar"><div class="mini-fill supply" id="t1-sup-bar" style="width:65%;"></div></div>
                            </div>
                            <div class="tc-metric consume-out">
                                <div class="tc-metric-label"><span class="ind consumption"></span> Consumption</div>
                                <div class="tc-metric-val" id="t1-con-val">1.8<span> L/min</span></div>
                                <div class="tc-metric-sub" id="t1-con-total">228 L today</div>
                                <div class="mini-bar"><div class="mini-fill consumption" id="t1-con-bar" style="width:48%;"></div></div>
                            </div>
                            <div class="tc-metric">
                                <div class="tc-metric-label">Volume</div>
                                <div class="tc-metric-val">1,100<span> L cap</span></div>
                                <div class="tc-metric-sub" id="t1-vol">Current: 858 L</div>
                                <div class="mini-bar"><div class="mini-fill level-t1" id="t1-vol-bar" style="width:78%;"></div></div>
                            </div>
                            <div class="tc-metric">
                                <div class="tc-metric-label">Temperature</div>
                                <div class="tc-metric-val" id="t1-temp">24.3<span> ¬∞C</span></div>
                                <div class="tc-metric-sub">Normal range</div>
                                <div class="mini-bar"><div class="mini-fill level-t1" style="width:45%;"></div></div>
                            </div>
                        </div>
                        <div class="tc-status">
                            <div class="tc-status-left"><span class="st-dot on"></span> Sensor Online</div>
                            <div class="tc-status-right" id="t1-ts">Updated 5s ago</div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- TINACO 2 -->
            <div class="tank-card t2">
                <div class="tc-header"><div class="tc-title">üíß Tinaco 2</div><div class="tc-badge">ROOF ‚Äî BACK</div></div>
                <div class="tc-body">
                    <div class="tank-vis">
                        <div class="tank-wrap">
                            <div class="tank-top"><div class="tank-pipe"></div></div>
                            <div class="tank-shell">
                                <div class="tank-fill" id="t2-fill" style="height:62%;">
                                    <div class="bbl" style="width:4px;height:4px;left:30%;bottom:10%;animation-delay:0.4s;"></div>
                                    <div class="bbl" style="width:5px;height:5px;left:50%;bottom:6%;animation-delay:1.7s;"></div>
                                    <div class="bbl" style="width:3px;height:3px;left:68%;bottom:16%;animation-delay:3.1s;"></div>
                                </div>
                            </div>
                            <div class="tank-scale"><span class="s-mk">100</span><span class="s-mk">75</span><span class="s-mk">50</span><span class="s-mk">25</span><span class="s-mk">0</span></div>
                        </div>
                        <div class="tank-pct" id="t2-pct">62<span>%</span></div>
                    </div>
                    <div class="tc-info">
                        <div class="tc-info-grid">
                            <div class="tc-metric supply-in">
                                <div class="tc-metric-label"><span class="ind supply"></span> Supply In</div>
                                <div class="tc-metric-val" id="t2-sup-val">1.9<span> L/min</span></div>
                                <div class="tc-metric-sub" id="t2-sup-total">272 L today</div>
                                <div class="mini-bar"><div class="mini-fill supply" id="t2-sup-bar" style="width:55%;"></div></div>
                            </div>
                            <div class="tc-metric consume-out">
                                <div class="tc-metric-label"><span class="ind consumption"></span> Consumption</div>
                                <div class="tc-metric-val" id="t2-con-val">2.1<span> L/min</span></div>
                                <div class="tc-metric-sub" id="t2-con-total">193 L today</div>
                                <div class="mini-bar"><div class="mini-fill consumption" id="t2-con-bar" style="width:42%;"></div></div>
                            </div>
                            <div class="tc-metric">
                                <div class="tc-metric-label">Volume</div>
                                <div class="tc-metric-val">1,100<span> L cap</span></div>
                                <div class="tc-metric-sub" id="t2-vol">Current: 682 L</div>
                                <div class="mini-bar"><div class="mini-fill level-t2" id="t2-vol-bar" style="width:62%;"></div></div>
                            </div>
                            <div class="tc-metric">
                                <div class="tc-metric-label">Temperature</div>
                                <div class="tc-metric-val" id="t2-temp">25.1<span> ¬∞C</span></div>
                                <div class="tc-metric-sub">Normal range</div>
                                <div class="mini-bar"><div class="mini-fill level-t2" style="width:48%;"></div></div>
                            </div>
                        </div>
                        <div class="tc-status">
                            <div class="tc-status-left"><span class="st-dot on"></span> Sensor Online</div>
                            <div class="tc-status-right" id="t2-ts">Updated 5s ago</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="bottom-row">
            <div class="panel">
                <div class="panel-head">
                    <div class="panel-title">Water Level History</div>
                    <div class="tabs">
                        <button class="tab-btn active" onclick="setTab(this)">24H</button>
                        <button class="tab-btn" onclick="setTab(this)">7D</button>
                        <button class="tab-btn" onclick="setTab(this)">30D</button>
                    </div>
                </div>
                <div class="chart-wrap">
                    <svg viewBox="0 0 700 200" preserveAspectRatio="none">
                        <defs>
                            <linearGradient id="gT1" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="rgba(79,172,254,0.4)"/><stop offset="100%" stop-color="rgba(79,172,254,0)"/></linearGradient>
                            <linearGradient id="gT2" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="rgba(167,139,250,0.4)"/><stop offset="100%" stop-color="rgba(167,139,250,0)"/></linearGradient>
                        </defs>
                        <line class="cg" x1="50" y1="20" x2="690" y2="20"/><line class="cg" x1="50" y1="65" x2="690" y2="65"/>
                        <line class="cg" x1="50" y1="110" x2="690" y2="110"/><line class="cg" x1="50" y1="155" x2="690" y2="155"/>
                        <text class="cl" x="40" y="24" text-anchor="end">100%</text><text class="cl" x="40" y="69" text-anchor="end">75%</text>
                        <text class="cl" x="40" y="114" text-anchor="end">50%</text><text class="cl" x="40" y="159" text-anchor="end">25%</text>
                        <text class="cl" x="90" y="190">00:00</text><text class="cl" x="197" y="190">04:00</text>
                        <text class="cl" x="304" y="190">08:00</text><text class="cl" x="411" y="190">12:00</text>
                        <text class="cl" x="518" y="190">16:00</text><text class="cl" x="625" y="190">20:00</text>
                        <path class="area-t1" d="M90,50 L143,46 L197,52 L250,42 L304,35 L357,40 L411,48 L464,38 L518,32 L571,36 L625,28 L678,34 L678,175 L90,175Z"/>
                        <path class="area-t2" d="M90,72 L143,78 L197,68 L250,80 L304,85 L357,74 L411,88 L464,78 L518,70 L571,82 L625,68 L678,75 L678,175 L90,175Z"/>
                        <polyline class="line-t1" points="90,50 143,46 197,52 250,42 304,35 357,40 411,48 464,38 518,32 571,36 625,28 678,34"/>
                        <polyline class="line-t2" points="90,72 143,78 197,68 250,80 304,85 357,74 411,88 464,78 518,70 571,82 625,68 678,75"/>
                        <circle class="cdot d1" cx="90" cy="50"/><circle class="cdot d1" cx="304" cy="35"/><circle class="cdot d1" cx="518" cy="32"/><circle class="cdot d1" cx="678" cy="34"/>
                        <circle class="cdot d2" cx="90" cy="72"/><circle class="cdot d2" cx="304" cy="85"/><circle class="cdot d2" cx="518" cy="70"/><circle class="cdot d2" cx="678" cy="75"/>
                    </svg>
                </div>
                <div class="chart-legend">
                    <div class="legend-i"><span class="legend-d l1"></span> Tinaco 1</div>
                    <div class="legend-i"><span class="legend-d l2"></span> Tinaco 2</div>
                </div>
            </div>
            <div class="panel">
                <div class="panel-head"><div class="panel-title">Activity Log</div></div>
                <div class="act-list">
                    <div class="act-item"><div class="act-icon i-in">üíß</div><div class="act-body"><strong>Tinaco 1</strong> supply pump ON ‚Äî refilling</div><div class="act-time">2m</div></div>
                    <div class="act-item"><div class="act-icon i-out">üìâ</div><div class="act-body"><strong>Tinaco 2</strong> consumption spike ‚Äî 2.8 L/min</div><div class="act-time">12m</div></div>
                    <div class="act-item"><div class="act-icon i-ok">‚úÖ</div><div class="act-body"><strong>Both sensors</strong> OK ‚Äî system check passed</div><div class="act-time">30m</div></div>
                    <div class="act-item"><div class="act-icon i-warn">‚ö†Ô∏è</div><div class="act-body"><strong>Tinaco 2</strong> below 60% threshold</div><div class="act-time">45m</div></div>
                    <div class="act-item"><div class="act-icon i-in">üíß</div><div class="act-body"><strong>Tinaco 1</strong> reached 85% ‚Äî pump OFF</div><div class="act-time">1h</div></div>
                    <div class="act-item"><div class="act-icon i-out">üìâ</div><div class="act-body"><strong>Tinaco 1</strong> high usage ‚Äî 15% above avg</div><div class="act-time">2h</div></div>
                    <div class="act-item"><div class="act-icon i-ok">‚úÖ</div><div class="act-body"><strong>Daily backup</strong> completed OK</div><div class="act-time">3h</div></div>
                </div>
            </div>
        </div>
    </div>

    <script src="js/water.js"></script>
</body>
</html>
